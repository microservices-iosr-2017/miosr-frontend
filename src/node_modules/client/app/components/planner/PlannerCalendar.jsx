import React from 'react';
import moment from 'moment';
import {Table} from 'react-bootstrap';
import Planner from 'schemas/PlannerSchema';
import {mealTypes} from 'schemas/PlannerEntrySchema';

import MealHeader from './MealHeader';
import MealEntries from './MealEntries';

const weekdays = () => new Array(7).fill(0).map((_, i) => moment(i, 'e'));

const PlannerCalendar = ({planner}) => {
  const days = weekdays();
  const mealNodes = [];
  mealTypes.forEach(meal => {
    mealNodes.push((
      <MealHeader meal={meal} days={days} key={`${meal}_header`} />
    ));
    mealNodes.push((
      <MealEntries planner={planner} meal={meal} days={days} key={`${meal}_entries`} />
    ));
  });

  return (
    <Table>
      <thead>
        <tr>
          {days.map(weekday => (
            <th key={weekday.unix()}>{weekday.format('ddd D/M')}</th>
          ))}
        </tr>
      </thead>
      <tbody>
        {mealNodes}
      </tbody>
    </Table>
  );
};

PlannerCalendar.propTypes = {
  planner: Planner.isRequired,
};

export default PlannerCalendar;
