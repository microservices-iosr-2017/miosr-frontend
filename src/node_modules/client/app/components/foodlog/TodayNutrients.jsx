import React from 'react';
import {Grid, Row, Col} from 'react-bootstrap';
import {NUTRIENTS_MAP} from 'client/sharedjs/NutrientsIDs';

const TodayNutrients = ({dataReady, values, units}) => {
  return (
    <Grid>
      <Row>Intake (daily)</Row>
      <Row>
        {['Energy', 'Proteins', 'Fat', 'Carbohydrates'].map(label =>
          (<Col sm={3}>{dataIfReadyOrZero(label, dataReady, values, units)}</Col>)
        )}
      </Row>
    </Grid>
  );
};

/* http://stackoverflow.com/a/18358056 */
function roundToTwo(num) {
  return +(Math.round(num + "e+2")  + "e-2");
}

function dataIfReadyOrZero(label, dataReady, values, units) {
  const id = NUTRIENTS_MAP[label.toLowerCase()];
  const defaultReply = `${label}: -`;

  if(dataReady) {
    if(!values[id]) {
      return defaultReply;
    } else {
      const formattedValue = roundToTwo(values[id]);
      return `${label}: ${formattedValue} ${units[id]}`;
    }
  } else {
    return defaultReply;
  }
}

export default TodayNutrients;
