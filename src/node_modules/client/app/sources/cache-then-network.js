export default ({remote, local}) => (...args) => (callback) => {
  let networkDataReceived = false;

  const networkUpdate = remote(...args)
    .then(response => {
      return response;
    })
    .then(data => {
      networkDataReceived = true;
      callback(null, data);
    });

  local(...args)
    .then(response => {
      if (!response) throw Error('No data');
      return response.json();
    })
    .then(data => {
      if (!networkDataReceived) {
        callback(null, data);
      }
    })
    .catch(() => {
      return networkUpdate;
    })
    .catch(callback);
};
