import BaseController from '../base';
import Recipe from './recipe.model';
import {respondWithResult, handleError,} from '../common';

export default class RecipeController extends BaseController(Recipe) {
  index(req, res) {
    if (!req.query.q) {
      return super.index(req, res);
    }

    return Recipe.find(
      {$text: {$search: req.query.q}},
      {score: {$meta: 'textScore'}},
    )
      .sort({score: {$meta: 'textScore'}})
      .exec()
      .then(respondWithResult(res))
      .catch(handleError(res));
  }
}
