/**
 * Main application routes
 */

'use strict';

import path from 'path';
import config from 'server/config/environment';
import errors from './components/errors';

export default function(app) {
  // Insert routes below
  app.use('/api/grocery_lists', require('./api/grocery_list').default);
  app.use('/api/foods', require('./api/food').default);
  app.use('/api/food_groups', require('./api/food/food_group').default);
  app.use('/api/food_search', require('./api/food/food_search').default);
  app.use('/api/foodlog', require('./api/foodlog').default);
  app.use('/api/recipes', require('./api/recipe').default);
  app.use('/api/users', require('./api/user').default);
  app.use('/api/planner', require('./api/planner').default);
  app.use('/api/example', require('./api/example').default);

  app.use('/auth', require('./auth').default);

  // All undefined asset or api routes should return a 404
  app.route('/:url(api|auth|app|index|images)/*')
    .get(errors[404]);

  // All other routes should redirect to the index.html (or return 404 if clientRoot
  // is not known
  if(config.clientRoot != null) {
    app.route('/*')
      .get((req, res) => {
        res.sendFile(path.resolve(`${config.clientRoot}/app.html`));
      });
  } else {
    app.route('/*').get(errors[404]);
  }
}

/*
- remove all server funcitonalities (how'll that impact testing? maybe leave node js for mocking?)
- simple static frontend which doesn't call api
 */
