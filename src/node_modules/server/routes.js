/**
 * Main application routes
 */

'use strict';

import path from 'path';
import config from 'server/config/environment';
import errors from './components/errors';

export default function(app) {
  // Insert routes below
  app.use('/api/example', require('./api/example').default);

  // All undefined asset or api routes should return a 404
  app.route('/:url(api|app|index|images)/*')
    .get(errors[404]);

  // All other routes should redirect to the index.html (or return 404 if clientRoot
  // is not known
  if(config.clientRoot != null) {
    app.route('/*')
      .get((req, res) => {
        res.sendFile(path.resolve(`${config.clientRoot}/app.html`));
      });
  } else {
    app.route('/*').get(errors[404]);
  }
}

/*
- remove all server funcitonalities (how'll that impact testing? maybe leave node js for mocking?)
- simple static frontend which doesn't call api
 */
